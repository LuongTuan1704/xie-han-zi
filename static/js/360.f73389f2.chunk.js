"use strict";(self.webpackChunkxie_han_zi=self.webpackChunkxie_han_zi||[]).push([[360],{3360:function(e,t,n){n.r(t),n.d(t,{default:function(){return q}});var a=n(4165),r=n(5861),i=n(3433),l=n(9439),c=n(390),s=n(2286),o=n(6851),d=n(9950),u=n(9766),p=n(6706),f="tab-controllers_wrapper__IrtVJ",_="tab-controllers_tabs__AKm3-",b="tab-controllers_Enable_fn_btns__qJyC6",m="tab-controllers_btn-wrapper__QEJJ0",x="tab-controllers_tab_btn_wraper__Ca1p+",h="tab-controllers_tabActive__7wpT3",v="tab-controllers_tab_btn_delete__QJC4q",g="tab-controllers_tab_btn__-12lp",j=n(2559);var N=function(e){var t=e.tab_array,n=e.Viewer,a=e.onTabClose,r=e.Enable_fn,i=(0,c.useState)((function(){var e,t=null===(e=JSON.parse(localStorage.getItem("tab_")))||void 0===e?void 0:e.tab_is_active_before_;return t&&n(t),t||void 0})),s=(0,l.Z)(i,2),o=s[0],d=s[1];return(0,c.useEffect)((function(){localStorage.setItem("tab_",JSON.stringify({tab_is_active_before_:o}))}),[o]),(0,c.useEffect)((function(){var e,a=null===(e=t[t.length-1])||void 0===e?void 0:e._id;n(a),d(a)}),[t.length]),console.log("render - tab c"),(0,j.jsxs)("div",{className:f,children:[(0,j.jsx)("div",{className:_,children:t.map((function(e){return(0,j.jsxs)("div",{className:"".concat(x," ").concat(o===e._id?h:""),children:[(0,j.jsx)("button",{className:g,onClick:function(){d(e._id),n(e._id)},children:e.name}),(0,j.jsx)("button",{className:v,onClick:function(){!function(e){a(e,e._id===o)}(e)},children:(0,j.jsx)(u.G,{icon:p.$9F})})]},e._id)}))}),(0,j.jsxs)("div",{className:b,children:[(0,j.jsxs)("div",{className:m,children:[(0,j.jsx)("input",{id:"Enable_readnable",type:"checkbox",onChange:function(e){r.setReadnableContent(e.target.checked,o)}}),(0,j.jsx)("label",{htmlFor:"Enable_readnable",title:"reader",children:(0,j.jsx)(u.G,{icon:p.lg3})})]}),(0,j.jsxs)("div",{className:m,children:[(0,j.jsx)("input",{id:"Enable_edit_mode",type:"checkbox",onChange:function(e){r.editingContent(e.target.checked,o)}}),(0,j.jsx)("label",{htmlFor:"Enable_edit_mode",title:"edit content",children:(0,j.jsx)(u.G,{icon:p._3l})})]})]})]})},E=n(7281),y={"float-form-content":"EditPanel_float-form-content__7d6I6",textarea:"EditPanel_textarea__Y-fFr","btn-group":"EditPanel_btn-group__WpbJe","reset-btn":"EditPanel_reset-btn__zgL+0","add-btn":"EditPanel_add-btn__ubJG0",wrapper:"EditPanel_wrapper__JEjCk",header:"EditPanel_header__WyqGL","close-edit-menu":"EditPanel_close-edit-menu__y6mu3","tippy-wrapper":"EditPanel_tippy-wrapper__HbFJl","props-input":"EditPanel_props-input__4dIrq",text_input:"EditPanel_text_input__LBD2-",section_heading:"EditPanel_section_heading__LbMeB","flex-col":"EditPanel_flex-col__8cuOg","flex-row":"EditPanel_flex-row__ZPp2R","btn-remove-element":"EditPanel_btn-remove-element__7HhEn","group-btns":"EditPanel_group-btns__UyB6q","tag-btn":"EditPanel_tag-btn__ePvvC",row:"EditPanel_row__GRBOo",selecedElement:"EditPanel_selecedElement__QVSgz","select-wrapper":"EditPanel_select-wrapper__qnUog",option:"EditPanel_option__ycASY","div-center":"EditPanel_div-center__CtiYt",buttons:"EditPanel_buttons__stwwF","checkbox-wrapper":"EditPanel_checkbox-wrapper__5i2N0"};function w(e,t){var n=(0,c.useState)(null),a=(0,l.Z)(n,2),r=a[0],i=a[1];(0,c.useImperativeHandle)(t,(function(){return{setTargetElement:i}})),(0,c.useEffect)((function(){return(0,E.on)("createElement",(function(e){var t=e.detail;i(t)})),null===r||void 0===r||r.classList.add("".concat(y.selecedElement)),function(){(0,E.S1)("createElement",(function(e){var t=e.detail;i(t)})),null===r||void 0===r||r.classList.remove("".concat(y.selecedElement))}}),[r]);var s=(0,c.useRef)();return(0,j.jsx)("div",{className:y["float-form-content"],children:(0,j.jsxs)("form",{onReset:function(e){e.preventDefault(),s.current.focus(),s.current.value=""},onSubmit:function(e){e.preventDefault(),s.current.focus(),function(e){var t=e.replaceAll("{",'<span data-text_view="true" >');t=t.replaceAll("}","</span>"),r.insertAdjacentHTML("beforeend",t)}(s.current.value)},children:[(0,j.jsx)("textarea",{className:y.textarea,placeholder:"add content",ref:s}),(0,j.jsxs)("div",{className:y["btn-group"],children:[(0,j.jsx)("button",{type:"submit",className:y["add-btn"],children:(0,j.jsx)(u.G,{icon:p.XSk})}),(0,j.jsx)("button",{type:"reset",className:y["reset-btn"],children:(0,j.jsx)(u.G,{icon:p.Vui})})]})]})})}var k=(0,c.forwardRef)(w),C=n(1413);function S(e){if(null==e)throw new TypeError("Cannot destructure undefined")}var T=n(810),P="color_SelectColorPanel__5BMDV",Z="color_header__fQVIU",O="color_header-radio-wrapper__TS1mA",I="color_main__XV7vN",A="color_item-wrapper__Jytd2",L=["#fafafa","#0f172a","#eab308","#3b82f6","#8b5cf6","#ef4444"];var R=function(e){var t=e.handleChangeElementStyles,n=[{label:"color",prop:"color"},{label:"bg-color",prop:"backgroundColor"},{label:"br-color",prop:"borderColor"}],a=(0,c.useState)(n[0]),r=(0,l.Z)(a,2),i=r[0],s=r[1];return(0,j.jsxs)("div",{className:P,children:[(0,j.jsx)("div",{className:Z,children:n.map((function(e){return(0,j.jsxs)("div",{className:O,children:[(0,j.jsx)("input",{type:"radio",name:"props-item",value:e.prop,id:e.label,onChange:function(e){s(e.target.value)}}),(0,j.jsx)("label",{htmlFor:"".concat(e.label),children:e.label})]},e.label)}))}),(0,j.jsx)("div",{className:I,children:L.map((function(e){return(0,j.jsxs)("div",{className:A,children:[(0,j.jsx)("input",{type:"radio",name:"color-item",value:e,id:e,onChange:function(e){t(i,e.target.value)}}),(0,j.jsx)("label",{htmlFor:"".concat(e),style:{backgroundColor:"".concat(e)}})]},e)}))})]})},H=n(5147),J=[{id:(0,T.x0)(5),label:"display",propName:"display",options:["","flex","block"]},{id:(0,T.x0)(5),label:"gap",propName:"gap"},{id:(0,T.x0)(5),label:"justify-content",propName:"justifyContent",options:["","flex-start","center","flex-end"]},{id:(0,T.x0)(5),label:"align-items",propName:"alignItems",options:["","flex-start","center","flex-end"]},{id:(0,T.x0)(5),label:"Font size",propName:"fontSize"},{id:(0,T.x0)(5),label:"line height",propName:"lineHeight"},{id:(0,T.x0)(5),label:"text align",propName:"textAlign",options:["","left","center","right","justify"]},{id:(0,T.x0)(5),label:"margin",propName:"margin"},{id:(0,T.x0)(5),label:"padding",propName:"padding"},{id:(0,T.x0)(5),label:"border",propName:"border"},{id:(0,T.x0)(5),label:"border - radius",propName:"borderRadius"}];function G(e,t){var n=(0,c.useState)(null),a=(0,l.Z)(n,2),r=a[0],i=a[1];(0,c.useImperativeHandle)(t,(function(){return{setTargetElement:i}}));var s=function(e,t){r&&(r.style[e]=t)},o=[{id:(0,T.x0)(5),label:"components:",tags:["container","paragraph","text"],fn:function(e,t){var n;switch(t){case"container":(n=document.createElement("div")).setAttribute("is_container",!0);break;case"paragraph":(n=document.createElement("p")).setAttribute("contenteditable",!1);break;case"text":(n=document.createElement("span")).style.display="inline-block",n.setAttribute("contenteditable",!1)}n.style.margin="15px 0",n.style.minHeight="15px",e.appendChild(n),(0,E.X$)("createElement",n),i(n)}},{id:(0,T.x0)(5),buttons:[{id:(0,T.x0)(5),icon:p.lg3,title:"enable speaker",type:"checkbox",defaultChecked:(null===r||void 0===r?void 0:r.dataset.readnable)||!1,fn:function(e){e?r.setAttribute("data-readnable",!0):r.removeAttribute("data-readnable",!0)}},{id:(0,T.x0)(5),icon:p._3l,title:"editing element ",type:"checkbox",defaultChecked:null===r||void 0===r?void 0:r.isContentEditable,fn:function(e){e?r.setAttribute("contenteditable",!0):r.removeAttribute("contenteditable")}},{id:(0,T.x0)(5),icon:p.Vui,title:"remove element",type:"button",fn:function(e){if(e.dataset.is_main_container)console.log("kh\xf4ng th\u1ec3 x\xf3a!");else{var t=e.parentNode;e.remove(),i(t)}}},{id:(0,T.x0)(5),icon:p.BgY,title:"select parentNode",type:"button",fn:function(e){i(e.parentNode)}}]}];return(0,c.useEffect)((function(){return null===r||void 0===r||r.classList.add("".concat(y.selecedElement)),function(){null===r||void 0===r||r.classList.remove("".concat(y.selecedElement))}}),[r]),(0,j.jsx)("div",{className:y.wrapper,children:r&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("section",{className:y.section_top,children:[o.map((function(e){return e.tags?(0,j.jsx)(H.ZP,{placement:"left-start",interactive:!0,hideOnClick:!1,render:function(t){var n=Object.assign({},(S(t),t));return(0,j.jsx)("div",(0,C.Z)((0,C.Z)({className:"tippy-wrapper",tabIndex:"-1"},n),{},{children:(0,j.jsxs)("div",{className:y["tippy-wrapper"],children:[(0,j.jsx)("span",{children:e.label}),(0,j.jsx)("div",{className:y["group-btns"],children:e.tags.map((function(t){return(0,j.jsx)("button",{className:y["tag-btn"],onClick:function(){e.fn(r,t)},children:t},(0,T.x0)(5))}))})]})}))},children:(0,j.jsx)("div",{className:y["div-center"],children:(0,j.jsx)(u.G,{icon:p.NkB})})},e.id):e.buttons?(0,j.jsx)("div",{className:y.buttons,children:e.buttons.map((function(e){return"button"===e.type?(0,j.jsx)("div",{children:!r.dataset.is_main_container&&(0,j.jsx)("button",{title:e.title,className:y["btn-remove-element"],onClick:function(){e.fn(r)},children:(0,j.jsx)(u.G,{icon:e.icon})})},e.id):(0,j.jsx)("div",{children:(0,j.jsxs)("div",{className:y["checkbox-wrapper"],children:[(0,j.jsx)("input",{id:"".concat(e.id),type:"checkbox",defaultChecked:e.defaultChecked,onChange:function(t){return e.fn(t.target.checked)}}),(0,j.jsx)("label",{htmlFor:"".concat(e.id),title:e.title,children:(0,j.jsx)(u.G,{icon:e.icon})})]},e.key)},e.id)}))},e.id):void 0})),(0,j.jsx)(H.ZP,{placement:"left-start",interactive:!0,hideOnClick:!1,render:function(e){var t=Object.assign({},(S(e),e));return(0,j.jsx)("div",(0,C.Z)((0,C.Z)({className:y["tippy-wrapper"],tabIndex:"-1"},t),{},{children:(0,j.jsx)(R,{handleChangeElementStyles:s})}))},children:(0,j.jsx)("div",{className:y["div-center"],children:(0,j.jsx)(u.G,{icon:p.q2v})})})]}),(0,j.jsx)(H.ZP,{placement:"left",interactive:!0,hideOnClick:!1,render:function(e){var t=Object.assign({},(S(e),e));return(0,j.jsx)("div",(0,C.Z)((0,C.Z)({className:"tippy-wrapper",tabIndex:"-1"},t),{},{children:(0,j.jsxs)("section",{className:y["tippy-wrapper"],children:[(0,j.jsx)("span",{className:y.section_heading,children:"Styles"}),(0,j.jsx)("div",{className:y["flex-col"],children:J.map((function(e){return e.options?(0,j.jsxs)("div",{className:y.row,children:[(0,j.jsx)("span",{children:e.label}),(0,j.jsx)("select",{className:y["select-wrapper"],onChange:function(t){return s(e.propName,t.target.value)},children:e.options.map((function(e){return(0,j.jsx)("option",{className:y.option,value:e,children:e},(0,T.x0)(5))}))})]},e.id):(0,j.jsxs)("div",{className:y.row,children:[(0,j.jsx)("span",{children:e.label}),(0,j.jsx)("input",{className:y["props-input"],defaultValue:r.style[e.propName]||"",type:"".concat(e.type||"text"),onChange:function(t){return s(e.propName,t.target.value)}})]},e.id)}))})]})}))},children:(0,j.jsx)("div",{className:y["div-center"],children:(0,j.jsx)(u.G,{icon:p.qHV})})})]})})}var M=(0,c.forwardRef)(G);function F(e,t){var n=(0,c.useRef)(),u=(0,c.useRef)(),p=(0,c.useState)(!1),f=(0,l.Z)(p,2),_=f[0],b=f[1],m=(0,c.useState)(!1),x=(0,l.Z)(m,2),h=x[0],v=x[1],g=(0,c.useRef)(),E=(0,c.useState)((function(){return JSON.parse(localStorage.getItem("tab_array"))||[]})),y=(0,l.Z)(E,2),w=y[0],C=y[1];(0,c.useEffect)((function(){w&&localStorage.setItem("tab_array",JSON.stringify(w))}),[w]);var S=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}g.current.innerHTML="page blank",e.next=8;break;case 4:return e.next=6,o.Db.files.where("_id").equals(t).first();case 6:n=e.sent,g.current.innerHTML=null===n||void 0===n?void 0:n.data;case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){var e=g.current;function t(t){if(_&&!h){if(t.target.dataset.readnable){var a=new SpeechSynthesisUtterance(t.target.innerText);a.lang="zh-CN",speechSynthesis.speak(a),a.onend=function(){console.log("finish!")}}}else h&&(e.style.cursor="pointer",n.current.setTargetElement(t.target),u.current.setTargetElement(t.target))}return e&&e.addEventListener("click",t),function(){console.log("clean up"),null===e||void 0===e||e.removeEventListener("click",t)}}),[h,_]);return(0,c.useImperativeHandle)(t,(function(){return{addNewTab:function(e){C((function(t){return t.find((function(t){return t._id===e._id}))?(s.Am.info("[ ".concat(e.name," ] is opend."),{position:s.Am.POSITION.BOTTOM_CENTER,toastId:"custom-id"}),t):(s.Am.success("Open [ ".concat(e.name," ] successfully!"),{position:s.Am.POSITION.BOTTOM_CENTER}),[].concat((0,i.Z)(t),[e]))}))}}})),(0,c.useEffect)((function(){var e,t;null===(e=n.current)||void 0===e||e.setFn(null===(t=u.current)||void 0===t?void 0:t.setTargetElement)}),[]),(0,j.jsxs)("div",{className:d.Z.wrapper,children:[(0,j.jsx)(N,{Viewer:S,onTabClose:function(e,t){var n=w.findIndex((function(t){return t._id===e._id})),l=(0,i.Z)(w);l.splice(n,1),t&&h?o.Db.transaction("rw",o.Db.files,(0,r.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.Db.files.where("_id").equals(e._id).modify((function(e){e.data=g.current.innerHTML})).then((function(){g.current.innerHTML=null,C(l)}));case 2:s.Am.success("Saved [ ".concat(e.name," ] successfully!"),{position:s.Am.POSITION.BOTTOM_CENTER});case 3:case"end":return t.stop()}}),t)})))).catch((function(e){console.error(e.stack)})):(g.current.innerHTML=null,C(l))},tab_array:w,Enable_fn:{setReadnableContent:b,editingContent:function(e,t){h&&t&&o.Db.transaction("rw",o.Db.files,(0,r.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Db.files.where("_id").equals(t).modify((function(e){e.data=g.current.innerHTML})).then((function(){s.Am.success("Saved [ ".concat(t," ] successfully!"),{position:s.Am.POSITION.BOTTOM_CENTER})}));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){console.error(e.stack)})),v(e)}}}),(0,j.jsxs)("div",{className:d.Z.main,children:[(0,j.jsxs)("div",{className:d.Z["flex-row"],style:{height:"".concat(h?70:100,"%")},children:[(0,j.jsx)("div",{ref:g,"data-is_main_container":!0,className:d.Z["main-content"]}),h&&(0,j.jsx)(M,{ref:n})]}),h&&(0,j.jsx)(k,{ref:u})]})]})}var q=(0,c.forwardRef)(F)}}]);
//# sourceMappingURL=360.f73389f2.chunk.js.map