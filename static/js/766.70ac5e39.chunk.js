"use strict";(self.webpackChunkxie_han_zi=self.webpackChunkxie_han_zi||[]).push([[766],{1766:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var r=n(4165),a=n(5861),s=n(9439),i=n(1413),c=n(3433),u=n(7313),o=n(259),l=n(1309),d=n(6250),h=n(771),f=n(7241),m=n(2751),g=n(6417),v=function(e,t){return{_id:e._id,type:t,ui:"Translate",data:e,translateText:e["c-v"===t?"hanzi":"Vietnamese_meaning"],lang:"c-v"===t?"Vi\u1ec7t":"Trung",answer:"".concat(e["c-v"===t?"Vietnamese_meaning":"hanzi"])}},p=function(e,t){if(t.listRender){for(var n=[["Vietnamese_meaning","hanzi"],["pinyin","hanzi"]],r=n.length,a=[[],[]],s=0;s<t.row;++s){var i=Math.floor(Math.random()*r);a[0][s]={a:e[s][n[i][0]],match:e[s][n[i][1]]},a[1][s]={b:e[s][n[i][1]],match:e[s][n[i][0]]}}(0,f.zz)(a[0]),(0,f.zz)(a[1]);for(var c={QuestionList:[],type:"Chooses",rows:t.row,isFinal:t.isFinal},u=0;u<a[0].length;++u)c.QuestionList.push({a:{q:a[0][u].a,match:a[0][u].match},b:{q:a[1][u].b,match:a[1][u].match}});return c}for(var o=void 0,l=0;l<e.length;l++)t.tempQTestArrayID.current.includes(e[l]._id)||(o=e[l]);if(o)return Math.random()>=.5?v(o,"c-v"):v(o,"v-c")},x=function(e,t){if(console.log(e.answer),!e.answer.trim())return{isOk:!0,match:100};var n=(0,c.Z)(e.answer.toLowerCase()).filter((function(e){return![" ",","].includes(e)})),r=(0,c.Z)(t.toLowerCase()).filter((function(e){return![" ",","].includes(e)})),a=.6*n.length,s=0,i=0;if("c-v"===e.type)for(var u=0;u<r.length;u++)n.includes(r[u])&&s++;if("v-c"===e.type){if(!e.data.Vietnamese_meaning.trim())return{isOk:!0,match:100};n.filter((function(e){return!!r.includes(e)&&(s++,!0)}))}for(var o=0;o<r.length;o++)n[o]===r[o]&&i++;return i===n.length?{isOk:!0,match:100}:s>a?{isOk:!0,match:~~(s/n.length*100)}:{isOk:!1,match:~~(s/n.length*100)}};function y(e){var t=e.data,n=e.style;return(0,g.jsxs)("li",{style:(0,i.Z)({},n),className:d.Z.T_row,children:[(0,g.jsx)("div",{"data-selected":0,"data-match":t.a.match,onClick:function(t){t.stopPropagation(),e.match(t)},className:d.Z.Item,children:t.a.q}),(0,g.jsx)("div",{"data-selected":0,"data-match":t.b.q,onClick:function(t){t.stopPropagation(),e.match(t)},className:d.Z.Item,children:t.b.q})]})}var T={Translate:function(e){var t=(0,u.useRef)(null);return(0,g.jsxs)("div",{className:d.Z["Q-wrapper"],children:[(0,g.jsxs)("header",{children:[" ","D\u1ecbch t\u1eeb v\u1ef1ng ph\xeda d\u01b0\u1edbi sang ti\u1ebfng ",e.datas.lang,"."]}),(0,g.jsxs)("main",{children:[(0,g.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},className:d.Z["T-Item"],onClick:function(){if("c-v"===e.datas.type){var t=new SpeechSynthesisUtterance(e.datas.data.hanzi);speechSynthesis.speaking||(t.lang="zh-CN",t.volume=1,speechSynthesis.speak(t))}},children:(0,g.jsx)("span",{style:{padding:"0 15px"},children:e.datas.translateText})}),(0,g.jsx)("div",{className:d.Z["T-Item"],children:(0,g.jsx)("form",{onSubmit:function(n){e.handleSubmit(n,t.current)},children:(0,g.jsx)("input",{type:"text",name:"answer",autoComplete:"off",placeholder:"nh\u1eadp b\u1ea3n d\u1ecbch"})})})]}),(0,g.jsx)("footer",{ref:t})]})},Chooses:function(e){var t=e.datas.QuestionList.length,n=(0,u.useRef)(0),r=(0,u.useRef)(null);(0,u.useEffect)((function(){return function(){n.current=0,r.current=null}}),[]);var a=function(a){if(!+a.target.dataset.selected)if(r.current)if(a.target.style.border="2px solid var(--BrightRed)",r.current.dataset.match===a.target.dataset.match){if(a.target.style.border="none",r.current.style.border="none",a.target.style.backgroundColor="var(--bg_green-hover)",r.current.style.backgroundColor="var(--bg_green-hover)",a.target.dataset.selected=1,r.current.dataset.selected=1,r.current=null,n.current++,n.current>=t&&!e.datas.isFinal)var s=setTimeout((function(){e.nextQuestion(),clearTimeout(s)}),1500);if(n.current>=t&&e.datas.isFinal)var i=setTimeout((function(){n.current=0,e.reset(!0),clearTimeout(i)}),1500)}else var c=setTimeout((function(){a.target.style.border="none",r.current.style.border="none",a.target.dataset.selected=0,r.current.dataset.selected=0,r.current=null,clearTimeout(c)}),500);else a.target.style.border="2px solid var(--BrightRed)",r.current=a.target,r.current.dataset.selected=1};return(0,g.jsx)("div",{className:d.Z["T-wrapper"],children:(0,g.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:(0,f.C1)(e.datas.QuestionList,5).map((function(e){return(0,g.jsx)("ul",{className:d.Z["T-list"],children:e.map((function(e){return(0,g.jsx)(y,{data:e,style:{height:"calc(100% /5)"},match:a},(0,m.x0)(5))}))},(0,m.x0)(5))}))})})}};function b(e){var t=e.tag,n=e.datas,i=e.props,c=(0,u.useState)(!1),m=(0,s.Z)(c,2),v=m[0],y=m[1],b=(0,u.useState)({ui:"Translate"}),k=(0,s.Z)(b,2),w=k[0],j=k[1],_=(0,u.useRef)(),Z=(0,u.useRef)([]),C=(0,u.useRef)({UI:T[(null===w||void 0===w?void 0:w.ui)||"Translate"]});(0,u.useLayoutEffect)((function(){console.log("reset"),C.current={UI:T[(null===w||void 0===w?void 0:w.ui)||"Translate"]}}),[v,null===w||void 0===w?void 0:w.ui]),(0,u.useEffect)((function(){return v&&(C.current={UI:T.Translate}),(0,a.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Db.tags.orderBy("id").toArray();case 2:return n=e.sent,e.abrupt("return",n.filter((function(e){return e._id===t._id}))[0].QTestArrayID);case 4:case"end":return e.stop()}}),e)})))().then((function(e){Z.current=e,e.length===n.length?y(!0):j(p(n,{tempQTestArrayID:Z}))})),(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._id){e.next=3;break}return e.next=3,(0,f.se)("tags","_id",{key:t._id,field:"QTestArrayID",newValue:Z.current}).then((function(){Z.current=[]}));case 3:case"end":return e.stop()}}),e)})))}),[]);var I=v?100:~~(Z.current.length/n.length*100),Q=(0,g.jsx)("button",{type:"reset",onClick:function(){(0,f.se)("tags","_id",{key:t._id,field:"QTestArrayID",newValue:[]}).then((function(){Z.current=[],y(!1),j(p(n,{tempQTestArrayID:Z}))}))},children:"reset"});return(0,g.jsx)("div",{className:d.Z["test-wrapper"],children:(0,g.jsxs)("div",{className:d.Z["test-container"],ref:_,children:[(0,g.jsxs)("header",{children:["\xd4n t\u1eadp t\u1eeb v\u1ef1ng ",t.tag_name," (",I," %)"]}),(0,g.jsx)("button",{className:d.Z["close-btn"],onClick:function(){i.back()},children:(0,g.jsx)(o.G,{icon:l.g82})}),v?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h3",{children:"\u0110\xe3 ho\xe0n th\xe0nh"}),Q]}):(0,g.jsx)(C.current.UI,{datas:w,handleSubmit:function(e,t){e.preventDefault();var r=Array.from(new FormData(e.target).entries())[0][1],a=x(w,r);a.match?100===a.match?t.innerText="d\u1ecbch \u0111\xfang 100% :)":t.innerText="d\u1ecbch \u0111\xfang kho\u1ea3ng : ".concat(a.match," %"):t.innerText="d\u1ecbch sai ho\xe0n to\xe0n :(",_.current.style.border="2px solid ".concat(a.isOk?"var(--LimeGreen)":"var(--BrightRed)"),a.isOk&&Z.current.push(w._id);var s=setTimeout((function(){if(clearTimeout(s),_.current.style.border="2px solid var(--boder-color)",t.innerText="",Z.current.length===n.length)return C.current={UI:T.Chooses},void j(p(n,{isFinal:!0,listRender:!0,row:n.length}));if(a.isOk){var r=Math.floor(Math.random()*n.length);switch(r){case 2:case 4:case 6:C.current={UI:T.Chooses},j(p(n,{isFinal:!1,listRender:!0,row:r}));break;default:j(p(n,{tempQTestArrayID:Z}))}}e.target.reset()}),1500)},reset:y,nextQuestion:function(){j(p(n,{tempQTestArrayID:Z}))}})]})})}}}]);